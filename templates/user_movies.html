<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ user.name }}'s Movies - MovieWeb App</title>
</head>
<body>
    {% extends "base.html" %}
    {% block title %}{{ user.name }}'s Movies - MovieWeb App{% endblock %}

    {% block content %}
    <h1 class="mb-4">{{ user.name }}'s Favorite Movies</h1>

    <table class="table table-striped table-hover">
      <thead>
        <tr>
          <th>Poster</th>
          <th>Name</th>
          <th>Director</th>
          <th>Year</th>
          <th>Rating</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for movie in movies %}
        <tr>
          <td>
            {% if movie.poster_url %}
              <img src="{{ movie.poster_url }}" alt="Poster for {{ movie.name }}" style="width: 60px; height: auto; border-radius: 4px;">
            {% else %}
              <span class="text-muted">No image</span>
            {% endif %}
          </td>
          <td>{{ movie.name }}</td>
          <td>{{ movie.director }}</td>
          <td>{{ movie.year }}</td>
          <td>{{ movie.rating }}</td>
          <td>
            <a href="{{ url_for('update_movie', user_id=user.id, movie_id=movie.id) }}" class="btn btn-sm btn-warning">Edit</a>
            <form action="{{ url_for('delete_movie', user_id=user.id, movie_id=movie.id) }}" method="post" class="d-inline">
              <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('Delete this movie?');">Delete</button>
            </form>
          </td>
        </tr>
        {% else %}
        <tr>
          <td colspan="6">No movies found.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <a href="{{ url_for('add_movie', user_id=user.id) }}" class="btn btn-success">Add New Movie</a>
    {% endblock %}
</body>
</html>